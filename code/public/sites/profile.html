<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="../styles/token-generation.css">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <script src="../out/moduleRequests_http/getModules_http.js"></script>
    <script src="../out/fe-repos/block-modules.js"></script>
    <script src="../out/generateToken_http/generateToken_http.js"></script>

    <script src="../out/webcomps/SideBar.js" defer></script>
    <script src="../out/webcomps/PluginListing.js" defer></script>

    <title>NiiC â€“ Store</title>
</head>
<body>
<niic-sidebar id="sidebar"></niic-sidebar>

<div class="niic-profile-bg-gradient-shadow"></div>

<div class="niic-profile-navigation">
    <p class="niic-profile-navigation-go-back">&#8592; Go back</p>

    <div class="niic-profile-inner-navigation">
        <p>Edit Profile</p>
        <p>Notification</p>
        <p>Language and Region</p>
        <p>Shortcuts</p>
        <p class="niic-profile-inner-navigation-this-sidebar-option">Token Generation</p>
        <p>Plugins</p>

    </div>
</div>

<div class="niic-profile-barrier-line"></div>

<div class="niic-plugin-store-main-container">
    <div class="niic-plugin-store-content-container">
        <h1 class="niic-profile-generation-token-title">Generate Token</h1>

        <div class="niic-profile-token-generation-generated-Token">
            <input class="niic-profile-token-generation-generated-token-input" style="flex: 2;" value="Generated Token"
                   readonly>
            <button class="niic-profile-token-generation-generate-button" onclick="generateToken_http()">Generate
                Token
            </button>
            <img class="niic-profile-token-generation-copy-image" src="../img/generateToken.svg" onclick="copyTokenInputValue()">
        </div>

        <div class="niic-profile-token-generation-kind_of_plugin">
            <p class="niic-profile-token-generation-kind_of_plugin-title">Kind of plugin</p>
            <div class="niic-profile-token-generation-kind_of_plugin-form">
                <form>
                    <div class="radios">
                        <label>
                            <input type="radio" name="moduleType" value="blm"/>
                            Block Module
                        </label>

                        <label>
                            <input type="radio" name="moduleType" value="bgm"/>
                            Background Module
                        </label>

                        <label>
                            <input type="radio" name="moduleType" value="dtm"/>
                            Data Module
                        </label>

                        <label>
                            <input type="radio" name="moduleType" value="mbd"/>
                            Module Bundle
                        </label>

                    </div>
                </form>
            </div>
        </div>


        <div class="niic-profile-token-generation-ReadAndWriteAccess-override-token">
            <div class="niic-profile-token-generation-read-and-write-access">
                <p class="niic-profile-token-generation-read-and-write-access-title">Read and write access</p>

                <div class="niic-profile-token-generation-read-and-write-access-rec">
                    <div class="niic-profile-token-generation-read-and-write-access-rec-title">
                        <p>others with read/write rights</p>
                    </div>

                    <div class="niic-profile-token-generation-read-and-write-access-rec-users">
                        <div class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                            <p></p>
                            <p>W</p>
                            <p>R</p>
                        </div>
                        <ul class="niic-profile-token-generation-read-and-write-access-rec-users-list">
                            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                                <p>yanni</p>
                                <input type="checkbox">
                                <input type="checkbox" checked>
                            </li>
                            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                                <p>ok</p>
                                <input type="checkbox" checked>
                                <input type="checkbox" checked>
                            </li>
                            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                                <p>ok</p>
                                <input type="checkbox" checked>
                                <input type="checkbox" checked>
                            </li>
                            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                                <p>ok</p>
                                <input type="checkbox" checked>
                                <input type="checkbox" checked>
                            </li>
                            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                                <p>ok</p>
                                <input type="checkbox" checked>
                                <input type="checkbox" checked>
                            </li>
                        </ul>
                        <button class="niic-profile-token-generation-read-and-write-access-rec-users-btn"
                                onclick="addUserPrompt();">+</button>
                    </div>
                </div>

            </div>

            <div class="niic-profile-token-generation-override-token">
                <p class="niic-profile-token-generation-override-token-title">Optional: Override your old token</p>

                <div class="niic-profile-token-generation-override-token-over-ride-token-check">
                    <input type="checkbox" id="overrideToken" onclick="alterOldTokenInput()">
                    <label for="overrideToken">Do you want to override an old token?</label><br>
                </div>

                <div class="niic-profile-token-generation-override-token-old-token">
                    <label for="niic-profile-token-generation-override-token-old-token-input">
                        Old Token
                    </label>

                    <input id="niic-profile-token-generation-override-token-old-token-input"
                           class="niic-profile-token-generation-override-token-old-token-input"
                           placeholder="Old Token"
                           disabled>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function alterOldTokenInput() {
        /** @type {HTMLInputElement | null} */
        const inputEl = document.querySelector(".niic-profile-token-generation-override-token-old-token-input");

        if (inputEl === null) {
            return;
        }

        inputEl.disabled = !inputEl.disabled;
    }

    function addUserPrompt() {
        const username = prompt("Please enter the username of the user you want to add to the list.", "here");

        if(!username){
            return;
        }

        const ul = document.querySelector(".niic-profile-token-generation-read-and-write-access-rec-users-list");
        ul.innerHTML += `
            <li class="niic-profile-token-generation-read-and-write-access-rec-users-list-item">
                <p>${username}</p>
                <input type="checkbox">
                <input type="checkbox">
            </li>
        `;
    }

    const radios = document.querySelectorAll("input");
    for (const radio of radios) {
        radio.addEventListener("click", () => {
            for (const r of radios) {
                if (r.checked === true) {
                    r.classList.add("selected-radio");
                } else {
                    r.classList.remove("selected-radio");
                }
            }
        });
    }

    async function copyTokenInputValue() {
        const inputElement = document.querySelector(".niic-profile-token-generation-generated-token-input");
        await navigator.clipboard.writeText(inputElement?.value);
        alert("Copied successfully! :)");
    }
</script>


</body>
</html>