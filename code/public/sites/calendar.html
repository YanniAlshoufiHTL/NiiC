<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>NiiC â€“ Calendar</title>
    <script src="../out/fe-models/NiicAet.js"></script>
    <script src="../out/fe-models/NiicAppointment.js"></script>
    <script src="../out/fe-models/NiicEvent.js"></script>
    <script src="../out/fe-models/NiicTask.js"></script>
    <script src="../out/webcomps/header-bar.js" defer></script>
    <script src="../out/webcomps/side-bar.js" defer></script>
    <script src="../out/webcomps/calendar-minimap.js" defer></script>
    <script src="../out/webcomps/calendar-view.js" defer></script>
    <script src="../out/webcomps/titled-search-list.js" defer></script>

    <link rel="stylesheet" href="../styles/global.css">
    <link rel="stylesheet" href="../styles/calendar.css">
</head>
<body>
<niic-sidebar></niic-sidebar>

<script>
    let date = new Date(Date.now());
</script>

<niic-header-bar>
    <div class="niic-header-list">
        <button class="niic-date-left-arrow" onclick="date.setDate(date.getDate() - 1); update();"><</button>
        <button class="niic-date-btn" onclick="date = new Date(Date.now()); update();"></button>
        <button class="niic-date-right-arrow" onclick="date.setDate(date.getDate() + 1); update();">></button>
    </div>

    <div class="niic-calendar-header-days">
        <p class="niic-calendar-header-days-0"></p>
        <p class="niic-calendar-header-days-1"></p>
        <p class="niic-calendar-header-days-2"></p>
        <p class="niic-calendar-header-days-3"></p>
        <p class="niic-calendar-header-days-4"></p>
        <p class="niic-calendar-header-days-5"></p>
        <p class="niic-calendar-header-days-6"></p>
    </div>

    <script>
        function update() {
            document.querySelector(".niic-date-btn").innerHTML = date.toDateString();

            const calMinimap = document.querySelector(".niic-cal-minimap");
            calMinimap.dataset.firstDay = date.toDateString();
            calMinimap.dataset.month = date.getMonth().toString();
            if (calMinimap.setFirstDay) {
                calMinimap.setFirstDay(date.toDateString());
            }

            const days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];

            const dateTmp = new Date(date.toDateString());
            for (let i = 0; i < 7; i++) {
                const el = document.querySelector(`.niic-calendar-header-days-${i}`);
                el.innerHTML = `${days[dateTmp.getDay()]}<br>${dateTmp.getDate()}`;
                dateTmp.setDate(dateTmp.getDate() + 1);
            }
        }

        setTimeout(() => {
            update();
        }, 0);
    </script>

    <style>
        .niic-header-list {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }

        .niic-calendar-header-days {
            position: absolute;
            top: 170px;
            right: 0;
            display: flex;
            width: calc(100vw - 81px - 296px);

            > p {
                flex: 1;
                text-align: center;
                font-family: system-ui, sans-serif;
                font-size: 1.3rem;
                color: white;
            }
        }
    </style>
</niic-header-bar>

<section class="niic-calendar-main-section">

    <aside class="niic-calendar-aside">
        <div class="niic-calendar-aside-minimap">
            <niic-calendar-minimap class="niic-cal-minimap"
                                   data-month="2"
                                   data-first-day="2024-02-29"></niic-calendar-minimap>
        </div>

        <div class="niic-calendar-aside-aet-lists">
            <niic-titled-search-list data-title="Tasks" class="niic-calendar-aside-list-tasks">
            </niic-titled-search-list>

            <niic-titled-search-list data-title="Events" class="niic-calendar-aside-list-events">
            </niic-titled-search-list>

            <niic-titled-search-list data-title="Appointments" class="niic-calendar-aside-list-appointments">
            </niic-titled-search-list>

        </div>
    </aside>

    <div class="niic-calendar-day-times">
        <p>01</p>
        <p>02</p>
        <p>01</p>
        <p>02</p>
        <p>03</p>
        <p>04</p>
        <p>05</p>
        <p>06</p>
        <p>07</p>
        <p>08</p>
        <p>09</p>
        <p>10</p>
        <p>11</p>
        <p>12</p>
        <p>13</p>
        <p>14</p>
        <p>15</p>
        <p>16</p>
        <p>17</p>
        <p>18</p>
        <p>19</p>
        <p>20</p>
        <p>21</p>
        <p>22</p>
        <p>23</p>
    </div>

    <main class="niic-calendar-main">
        <script>
            const els = [];

            for (let i = 0; i < 7; i++) {
                els.push(`<div></div>`);
            }

            document.querySelector(".niic-calendar-main").innerHTML = els.join("\n");
        </script>
    </main>
</section>


<script>
    /** @type {NiicTask[]} */
    const tasks = [
        new NiicTask("Hi", 3, 10, "Do something")
    ];

    /** @type {NiicEvent[]} */
    const events = [
        new NiicEvent("An event with a very very long name.", 5, 14, "Do something")
    ];

    /** @type {NiicAppointment[]} */
    const appointments = [
        new NiicAppointment("Do something", 15, 20),
        new NiicAppointment("Do something else", 20, 21),
        new NiicAppointment("An appointment with a long name.", 2, 9),
    ];

    const getItemsHtml = (arr) =>
        arr.map(x => `<li>${x.title}</li>`).join("\n");

    document.querySelector(".niic-calendar-aside-list-tasks").innerHTML = getItemsHtml(tasks);
    document.querySelector(".niic-calendar-aside-list-events").innerHTML = getItemsHtml(events);
    document.querySelector(".niic-calendar-aside-list-appointments").innerHTML = getItemsHtml(appointments);
</script>

</body>
</html>